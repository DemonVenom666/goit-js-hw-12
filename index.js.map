{"version":3,"file":"index.js","sources":["../src/js/apiKey.js","../src/js/refs.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export default { KEY: '45785559-b0577f06fb94f4ced9a4d3280', BASE_URL: 'https://pixabay.com/api/' }","export default { form: document.querySelector('.js-form'), gallery: document.querySelector('.js-gallery'), loader: document.querySelector('.loader'), loadMore: document.querySelector('.load-more') };","import apiKey from \"./apiKey\";\nconst { KEY, BASE_URL } = apiKey;\nimport refs from \"./refs\";\nconst { loader } = refs;\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nconst perPage = 15;\n\nexport async function getSearch(searchText, currentPage) {\n    try {\n        if (searchText.includes(' ')) {\n            searchText.replace(/\\s+/g, '+');\n        }\n        // if (!resp.data.hits.length) {\n        //     throw new Error(\n        //         iziToast.error({\n        //             message: 'Sorry, there are no images matching your search query. Please try again!',\n        //         })\n        //     );\n        // }\n        \n        const response = await axios.get(`${BASE_URL}`, {\n            params: {\n                key: KEY,\n                q: searchText,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page: currentPage,\n                per_page: perPage,\n            }\n        })\n        return response;\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Sorry! The site is currently unavailable. Please try later!',\n        });\n        console.error(error.message);\n    }\n}\n","export function createMarkup(array) {\n    return array.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"thumb-block\">\n        <div class=\"block\">\n          <h2 class=\"title\">Likes</h2>\n          <p class=\"amount\">${likes}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Views</h2>\n          <p class=\"amount\">${views}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Comments</h2>\n          <p class=\"amount\">${comments}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Downloads</h2>\n          <p class=\"amount\">${downloads}</p>\n        </div>\n      </div>\n    </li>`).join('');\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getSearch } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\nimport refs from \"./js/refs\";\nconst { form, gallery, loader, loadMore } = refs;\n\nlet saveQuery = '';\nlet currentPage = 1;\nconst perPage = 15;\nlet refreshPage;\n\nloader.style.display = 'none';\nloadMore.classList.add('hidden');\n\nform.addEventListener('submit', onSearch);\nloadMore.addEventListener('click', loadBtn);\n\nfunction onSearch(evt) {\n    evt.preventDefault()\n\n    currentPage = 1;\n    gallery.innerHTML = '';\n    loader.style.display = 'block';\n    saveQuery = evt.target.elements.query.value.trim();\n\n\n    if (saveQuery === '') {\n        return iziToast.info({\n            title: 'Hello',\n            message: 'Please enter search text!',\n        }),\n            loader.style.display = 'none',\n            form.reset()\n    }\n\n\n    getSearch(saveQuery, currentPage)\n        .then(resp => {\n\n\n            gallery.insertAdjacentHTML(\"beforeend\", createMarkup(resp.data.hits));\n            loadMore.classList.remove('hidden');\n\n            console.log(resp.data.totalHits);\n            \n            if (currentPage * perPage >= resp.data.totalHits) {\n                loadMore.classList.add('hidden');\n            }\n\n            if (currentPage === resp.data.hits) {\n                loadMore.classList.add('hidden');\n            }\n            if (!resp.data.hits.length) {\n                iziToast.error({\n                    title: 'Error',\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                }),\n                    loader.style.display = 'none',\n                    loadMore.classList.add('hidden');\n                return;\n            }\n\n            loader.style.display = 'none';\n\n            refreshPage = new SimpleLightbox('.gallery a', {\n                captions: true,\n                captionsData: 'alt',\n                captionDelay: 250,\n            });\n            refreshPage.refresh();\n        })\n        .catch(err => {\n            loader.style.display = 'none';\n            console.log(`${err}`)\n        });\n    form.reset();\n}\n\n\nfunction loadBtn() {\n    currentPage += 1;\n    const getHeightImgCard = () => document.querySelector('.gallery-item').getBoundingClientRect();\n\n    getSearch(saveQuery, currentPage).then(resp => {\n        gallery.insertAdjacentHTML(\"beforeend\", createMarkup(resp.data.hits));\n        window.scrollBy({\n            top: getHeightImgCard().height * 2,\n            left: 0,\n            behavior: \"smooth\",\n        });\n        refreshPage.refresh();\n\n        if (currentPage * perPage >= resp.data.totalHits) {\n            iziToast.info({\n                title: 'Caution',\n                message: `We're sorry, but you've reached the end of search results.`,\n            }),\n            loadMore.classList.add('hidden');\n        }\n    })\n\n}\n\n\n\nfunction scrollingTopPage() {\n    document.addEventListener('DOMContentLoaded', function () {\n        const upButton = document.querySelector('.up-btn');\n\n        upButton.addEventListener('click', function () {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n\n            document.body.classList.add('scrolling');\n        });\n\n        window.addEventListener('scroll', function () {\n            if (window.scrollY > 200) {\n                upButton.classList.add('show');\n            } else {\n                upButton.classList.remove('show');\n            }\n\n            if (document.body.classList.contains('scrolling') && window.scrollY === 0) {\n                document.body.classList.remove('scrolling');\n            }\n        });\n    });\n}\nscrollingTopPage();"],"names":["apiKey","refs","KEY","BASE_URL","perPage","getSearch","searchText","currentPage","axios","error","iziToast","createMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","gallery","loader","loadMore","saveQuery","refreshPage","onSearch","loadBtn","evt","resp","SimpleLightbox","err","getHeightImgCard","scrollingTopPage","upButton"],"mappings":"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"}