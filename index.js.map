{"version":3,"file":"index.js","sources":["../src/js/apiKey.js","../src/js/refs.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/scrollTop.js","../src/main.js"],"sourcesContent":["export default { KEY: '45785559-b0577f06fb94f4ced9a4d3280', BASE_URL: 'https://pixabay.com/api/' }","export default { form: document.querySelector('.js-form'), gallery: document.querySelector('.js-gallery'), loader: document.querySelector('.loader'), loadMore: document.querySelector('.load-more') };","import apiKey from \"./apiKey\";\nconst { KEY, BASE_URL } = apiKey;\nimport refs from \"./refs\";\nconst { loader } = refs;\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nconst perPage = 15;\n\nexport async function getSearch(searchText, currentPage) {\n    try {\n        if (searchText.includes(' ')) {\n            searchText.replace(/\\s+/g, '+');\n        }\n        const response = await axios.get(`${BASE_URL}`, {\n            params: {\n                key: KEY,\n                q: searchText,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page: currentPage,\n                per_page: perPage,\n            }\n        })\n        return response;\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Sorry! The site is currently unavailable. Please try later!',\n        });\n        console.error(error.message);\n    }\n}\n","export function createMarkup(array) {\n    return array.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"thumb-block\">\n        <div class=\"block\">\n          <h2 class=\"title\">Likes</h2>\n          <p class=\"amount\">${likes}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Views</h2>\n          <p class=\"amount\">${views}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Comments</h2>\n          <p class=\"amount\">${comments}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Downloads</h2>\n          <p class=\"amount\">${downloads}</p>\n        </div>\n      </div>\n    </li>`).join('');\n}","export { scrollingTopPage }\n\nfunction scrollingTopPage() {\n    document.addEventListener('DOMContentLoaded', function () {\n        const upButton = document.querySelector('.up-btn');\n\n        upButton.addEventListener('click', function () {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n\n            document.body.classList.add('scrolling');\n        });\n\n        window.addEventListener('scroll', function () {\n            if (window.scrollY > 200) {\n                upButton.classList.add('show');\n            } else {\n                upButton.classList.remove('show');\n            }\n\n            if (document.body.classList.contains('scrolling') && window.scrollY === 0) {\n                document.body.classList.remove('scrolling');\n            }\n        });\n    });\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getSearch } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\nimport refs from \"./js/refs\";\nconst { form, gallery, loader} = refs;\nimport { scrollingTopPage } from \"./js/scrollTop\";\n\nlet saveQuery = '';\nlet currentPage = 1;\nconst perPage = 15;\nlet refreshPage;\nlet animItems;\n\nloader.style.display = 'none';\n\nform.addEventListener('submit', onSearch);\n\nscrollingTopPage();\n\nfunction animOnScroll() {\n    if (!animItems) return;\n    for (let index = 0; index < animItems.length; index++) {\n        const animItem = animItems[index];\n        const animItemHeight = animItem.offsetHeight\n        const animItemOffset = offset(animItem).top;\n        const animStart = 9;\n\n        let animItemPoint = window.innerHeight - animItemHeight / animStart;\n\n        if (animItemHeight > window.innerHeight) {\n            animItemPoint = window.innerHeight - window.innerHeight / animStart;\n        }\n\n        if ((pageYOffset > animItemOffset - animItemPoint) && pageYOffset < (animItemOffset + animItemHeight)) {\n            animItem.classList.add('show');\n        } else {\n            animItem.classList.remove('show')\n        }\n    }\n}\nfunction offset(el) {\n    const rect = el.getBoundingClientRect(),\n        scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n        scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n    return { top: rect.top + scrollTop, left: rect.left + scrollLeft }\n}\n\nwindow.addEventListener('scroll', animOnScroll);\n\nfunction onSearch(evt) {\n    evt.preventDefault()\n    currentPage = 1;\n    gallery.innerHTML = '';\n    loader.style.display = 'block';\n    saveQuery = evt.target.elements.query.value.trim();\n\n    window.addEventListener('scroll', infiniteScroll);\n\n    if (saveQuery === '') {\n        return iziToast.info({\n            title: 'Hello',\n            message: 'Please enter search text!',\n        }),\n            loader.style.display = 'none',\n            // loadMore.classList.add('hidden'),\n            form.reset()\n    }\n\n\n    getSearch(saveQuery, currentPage)\n        .then(resp => {\n\n\n            gallery.insertAdjacentHTML(\"beforeend\", createMarkup(resp.data.hits));\n\n            animItems = document.querySelectorAll('.gallery-item');\n            animOnScroll();\n\n            if (!resp.data.hits.length) {\n                iziToast.error({\n                    title: 'Error',\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                }),\n                    loader.style.display = 'none';\n                return;\n            }\n\n            loader.style.display = 'none';\n\n            refreshPage = new SimpleLightbox('.gallery a', {\n                captions: true,\n                captionsData: 'alt',\n                captionDelay: 250,\n            });\n            refreshPage.refresh();\n        })\n        .catch(err => {\n            loader.style.display = 'none';\n            console.log(`${err}`)\n        });\n    form.reset();\n}\n\nfunction infiniteScroll() {\n    const documentRect = document.documentElement.getBoundingClientRect();\n\n    // Проверяем, достиг ли пользователь конца страницы\n    if (documentRect.bottom <= document.documentElement.clientHeight + 100) {  // Добавим небольшой отступ в 100 пикселей\n        currentPage += 1;\n        const getHeightImgCard = () => document.querySelector('.gallery-item').getBoundingClientRect();\n\n        getSearch(saveQuery, currentPage).then(resp => {\n            gallery.insertAdjacentHTML(\"beforeend\", createMarkup(resp.data.hits));\n\n            animItems = document.querySelectorAll('.gallery-item');\n            animOnScroll();\n\n            window.scrollBy({\n                top: getHeightImgCard().height * 2,\n                left: 0,\n                behavior: \"smooth\",\n            });\n            refreshPage.refresh();\n\n            // Проверяем, достигли ли конца всех результатов поиска\n            if (currentPage * perPage >= resp.data.totalHits) {\n                iziToast.info({\n                    title: 'Caution',\n                    message: `We're sorry, but you've reached the end of search results.`,\n                });\n\n                // Удаляем обработчик события, чтобы остановить бесконечную прокрутку\n                window.removeEventListener('scroll', infiniteScroll);\n\n                return;\n            }\n        }).catch(error => {\n            console.error(\"Ошибка при загрузке результатов поиска:\", error);\n            iziToast.error({\n                title: 'Error',\n                message: 'Произошла ошибка при загрузке данных. Пожалуйста, попробуйте позже.',\n            });\n        });\n    }\n}\n"],"names":["apiKey","refs","KEY","BASE_URL","perPage","getSearch","searchText","currentPage","axios","error","iziToast","createMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","scrollingTopPage","upButton","form","gallery","loader","saveQuery","refreshPage","animItems","onSearch","animOnScroll","index","animItem","animItemHeight","animItemOffset","offset","animStart","animItemPoint","el","rect","scrollLeft","scrollTop","evt","infiniteScroll","resp","SimpleLightbox","err","getHeightImgCard"],"mappings":"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"}