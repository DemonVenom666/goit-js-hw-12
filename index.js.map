{"version":3,"file":"index.js","sources":["../src/js/apiKey.js","../src/js/refs.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/scrollTop.js","../src/main.js"],"sourcesContent":["export default { KEY: '45785559-b0577f06fb94f4ced9a4d3280', BASE_URL: 'https://pixabay.com/api/' }","export default { form: document.querySelector('.js-form'), gallery: document.querySelector('.js-gallery'), loader: document.querySelector('.loader'), result: document.querySelector('.total-result'), resultSpan: document.querySelector('.result-span')};","import apiKey from \"./apiKey\";\nconst { KEY, BASE_URL } = apiKey;\nimport refs from \"./refs\";\nconst { loader } = refs;\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nconst perPage = 15;\n\nexport async function getSearch(searchText, currentPage) {\n    try {\n        if (searchText.includes(' ')) {\n            searchText.replace(/\\s+/g, '+');\n        }\n        const response = await axios.get(`${BASE_URL}`, {\n            params: {\n                key: KEY,\n                q: searchText,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page: currentPage,\n                per_page: perPage,\n            }\n        })\n        return response;\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Sorry! The site is currently unavailable. Please try later!',\n        });\n        console.error(error.message);\n    }\n}\n","export function createMarkup(array) {\n    return array.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"thumb-block\">\n        <div class=\"block\">\n          <h2 class=\"title\">Likes</h2>\n          <p class=\"amount\">${likes}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Views</h2>\n          <p class=\"amount\">${views}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Comments</h2>\n          <p class=\"amount\">${comments}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Downloads</h2>\n          <p class=\"amount\">${downloads}</p>\n        </div>\n      </div>\n    </li>`).join('');\n}","export { scrollingTopPage }\n\nfunction scrollingTopPage() {\n    document.addEventListener('DOMContentLoaded', function () {\n        const upButton = document.querySelector('.up-btn');\n\n        upButton.addEventListener('click', function () {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n\n            document.body.classList.add('scrolling');\n        });\n\n        window.addEventListener('scroll', function () {\n            if (window.scrollY > 200) {\n                upButton.classList.add('show');\n            } else {\n                upButton.classList.remove('show');\n            }\n\n            if (document.body.classList.contains('scrolling') && window.scrollY === 0) {\n                document.body.classList.remove('scrolling');\n            }\n        });\n    });\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getSearch } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\nimport refs from \"./js/refs\";\nconst { form, gallery, loader, result, resultSpan } = refs;\nimport { scrollingTopPage } from \"./js/scrollTop\";\n\n\nlet saveQuery = '';\nlet currentPage = 1;\nconst perPage = 15;\nlet refreshPage;\nlet animItems;\n\nloader.style.display = 'none';\nresult.style.display = 'none';\n\nform.addEventListener('submit', onSearch);\n\nscrollingTopPage();\n\nfunction animOnScroll() {\n    if (!animItems) return;\n    const triger = window.innerHeight + 100;\n    for (let index = 0; index < animItems.length; index++) {\n        const animItem = animItems[index];\n        const topOfBoxes = animItem.getBoundingClientRect().top;\n        if (topOfBoxes < triger) {\n            animItem.classList.add('show');\n        }\n    }\n}\n\nwindow.addEventListener('scroll', animOnScroll);\n\nfunction onSearch(evt) {\n    evt.preventDefault()\n    currentPage = 1;\n    gallery.innerHTML = '';\n    loader.style.display = 'block';\n    \n    saveQuery = evt.target.elements.query.value.trim();\n\n    window.addEventListener('scroll', infiniteScroll);\n\n    if (saveQuery === '') {\n        return iziToast.info({\n            title: 'Hello',\n            message: 'Please enter search text!',\n        }),\n            loader.style.display = 'none',\n            result.style.display = 'none',\n            form.reset()\n    }\n\n\n    getSearch(saveQuery, currentPage)\n        .then(resp => {\n            result.style.display = 'block';\n            resultSpan.textContent = `${resp.data.totalHits}`;\n            \n            gallery.insertAdjacentHTML(\"beforeend\", createMarkup(resp.data.hits));\n\n            animItems = document.querySelectorAll('.gallery-item');\n            animOnScroll();\n\n            if (!resp.data.hits.length) {\n                iziToast.error({\n                    title: 'Error',\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                }),\n                    loader.style.display = 'none',\n                    result.style.display = 'none';\n                return;\n            }\n\n            loader.style.display = 'none';\n\n            refreshPage = new SimpleLightbox('.gallery a', {\n                captions: true,\n                captionsData: 'alt',\n                captionDelay: 250,\n            });\n            refreshPage.refresh();\n        })\n        .catch(err => {\n            loader.style.display = 'none';\n            console.log(`${err}`)\n        });\n    form.reset();\n}\n\nfunction infiniteScroll() {\n    const documentRect = document.documentElement.getBoundingClientRect();\n\n    // Проверяем, достиг ли пользователь конца страницы\n    if (documentRect.bottom <= document.documentElement.clientHeight + 100) {  // Добавим небольшой отступ в 100 пикселей\n        currentPage += 1;\n        const getHeightImgCard = () => document.querySelector('.gallery-item').getBoundingClientRect();\n\n        getSearch(saveQuery, currentPage).then(resp => {\n            gallery.insertAdjacentHTML(\"beforeend\", createMarkup(resp.data.hits));\n\n            animItems = document.querySelectorAll('.gallery-item');\n            animOnScroll();\n\n            window.scrollBy({\n                top: getHeightImgCard().height * 2,\n                left: 0,\n                behavior: \"smooth\",\n            });\n            refreshPage.refresh();\n\n            // Проверяем, достигли ли конца всех результатов поиска\n            if (currentPage * perPage >= resp.data.totalHits) {\n                iziToast.info({\n                    title: 'Caution',\n                    message: `We're sorry, but you've reached the end of search results.`,\n                });\n\n                // Удаляем обработчик события, чтобы остановить бесконечную прокрутку\n                window.removeEventListener('scroll', infiniteScroll);\n\n                return;\n            }\n        }).catch(error => {\n            console.error(\"Ошибка при загрузке результатов поиска:\", error);\n            iziToast.error({\n                title: 'Error',\n                message: 'Произошла ошибка при загрузке данных. Пожалуйста, попробуйте позже.',\n            });\n        });\n    }\n}\n"],"names":["apiKey","refs","KEY","BASE_URL","perPage","getSearch","searchText","currentPage","axios","error","iziToast","createMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","scrollingTopPage","upButton","form","gallery","loader","result","resultSpan","saveQuery","refreshPage","animItems","onSearch","animOnScroll","triger","index","animItem","evt","infiniteScroll","resp","SimpleLightbox","err","getHeightImgCard"],"mappings":"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"}